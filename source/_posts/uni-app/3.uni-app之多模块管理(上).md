---
title: 3.uni-app之多模块管理(上)
tags: [uni-app,跨端开发]
slug: w65034i
keywords: uni-app,多端同构,多端开发技巧,跨端开发
date: 2024-10-26 17:18:36
---

我们团队uni-app项目是在一个项目里面开发维护里面,时间久了这个项目就变成了一个巨无霸项目.

再加上后来基于uni-app开发的app项目,为了共存和协同.

我们使用以下方案来维护我们的代码.

## 使用npm来管理我们的业务模块

### 业务的主工程

这是我们实践的方案,首先我们创建一个项目为uni的主工程，负责组合各业务端的代码.

里面没有任何的业务代码,只有在根目录下有一个manifest.json和pages.json的文件，

负责授权模块和路由采集及分包.

之前的一篇文章我已经提到,我们所有的模块依赖都是统一的,并且版本锁死.

有兴趣的可以点击查看:

[uni-app跨端开发之依赖管理](https://codcer.github.io/2024/10/26/uni-app/2.uni-app跨端开发之依赖管理问题/)

所以主工程的依赖与业务模块的依赖是保持一致的.

### 使用npm管理业务模块

我们会把所有的业务模块当成子包来管理,很容易统一管理他们.

当然这些业务模块我们不会把他发布到npm服务器上,因为业务代码会频繁变动,如果每一次提交都要上传到npm服务器,自然会添加开发人员的代码管理成本(发布npm包很烦的)

所以我们使用 `npm + git` 地址来拉取我们的业务模块.

例如:

#### 主工程的package.json

```json

{
    "name": "base",
    "version": "0.0.x",
    "scripts": {
        "build":"构建相关命令"
    },
    "dependencies": {
        "公共包": "1.0.0",
        "Module1": "http://xxx.com/xx-web/Module1.git",
        "Module2": "http://xxx.com/xx-web/Module2.git",
        // ...其它page模块
    }
}

```

#### 业务模块的package.json

业务模块添加了postinstall,在使用npm拉取业务模块成功之后,业务模块会在 `node_modules` 中构建自己的项目,提供给主工程的`page.json`使用

```json

{
    "name": "biz",
    "version": "0.0.1",
    "main": "main.js", 
    "scripts": {
        "build":"构建相关命令",
        "postinstall":"npm run build"
    },
    "dependencies": {
        "公共包": "1.0.0"
    }
}

```

### 业务模块之间相互调试

业务与业务之间肯定会有相互联调的情况,以上的方案业务模块只能独立运行自己的代码,当我们想要跳转到其它页面的时候,那就不行了.

其实我们可以让所有的业务模块跟主模块一样,在开发调试的时候引入所有的业务模块.

这样所有的业务代码都可以跑起来了,区别只在于其它业务模块放在`node_modules`中,不能修改代码.

### 该方案的优劣势

该方案建议中型的项目推荐

优点:

1. 主工程就可以作为统一页面注册，业务包只需要关注自己主包和跳转包即可

2. 所有业务模块单独维护,避免了项目巨无霸的产生

3. 业务与业务之间也可以相互跳转,单独一个业务模块也可以拉起完整的项目

缺点:

1. npm install 项目的时候会非常耗时,因为不单要安装依赖.

2. 业务模块更新之后,必须要重新npm install